<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>HtmlHelper.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">PrimeNumberGenerator</a> &gt; <a href="index.source.html" class="el_package">org.example.primeapi.view</a> &gt; <span class="el_source">HtmlHelper.java</span></div><h1>HtmlHelper.java</h1><pre class="source lang-java linenums">package org.example.primeapi.view;

import org.example.primeapi.model.PrimePayload;

import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Arrays;
import java.util.Comparator;
import java.util.List;

<span class="nc" id="L12">public class HtmlHelper {</span>



    public static List&lt;String&gt; getMarkdownFiles() {
        try {
<span class="nc" id="L18">            var uri = HtmlHelper.class.getClassLoader().getResource(&quot;docs&quot;);</span>
<span class="nc bnc" id="L19" title="All 2 branches missed.">            if (uri == null) return List.of();</span>

<span class="nc" id="L21">            File docsDir = new File(uri.toURI());</span>
<span class="nc" id="L22">            File[] files = docsDir.listFiles((dir, name) -&gt; name.endsWith(&quot;.md&quot;));</span>
<span class="nc bnc" id="L23" title="All 2 branches missed.">            if (files == null) return List.of();</span>

<span class="nc" id="L25">            return Arrays.stream(files)</span>
<span class="nc" id="L26">                    .sorted(Comparator.comparing(File::getName))</span>
<span class="nc" id="L27">                    .map(File::getName)</span>
<span class="nc" id="L28">                    .toList();</span>

<span class="nc" id="L30">        } catch (Exception e) {</span>
<span class="nc" id="L31">            return List.of(); // fallback if running from inside a JAR</span>
        }
    }

    public static List&lt;String&gt; getMarkdownFilenames() {
        try {
<span class="nc" id="L37">            var uri = HtmlHelper.class.getClassLoader().getResource(&quot;docs&quot;);</span>
<span class="nc bnc" id="L38" title="All 2 branches missed.">            if (uri == null) return List.of();</span>

<span class="nc" id="L40">            File docsDir = new File(uri.toURI());</span>
<span class="nc" id="L41">            File[] files = docsDir.listFiles((dir, name) -&gt; name.endsWith(&quot;.md&quot;));</span>
<span class="nc bnc" id="L42" title="All 2 branches missed.">            if (files == null) return List.of();</span>

<span class="nc" id="L44">            return Arrays.stream(files)</span>
<span class="nc" id="L45">                    .sorted(Comparator.comparing(File::getName))</span>
<span class="nc" id="L46">                    .map(File::getName)</span>
<span class="nc" id="L47">                    .toList();</span>

<span class="nc" id="L49">        } catch (Exception e) {</span>
<span class="nc" id="L50">            return List.of(); // fallback if running from inside a JAR</span>
        }
    }

    public static String buildSidebar(List&lt;String&gt; filenames) {
<span class="nc" id="L55">        StringBuilder sidebar = new StringBuilder();</span>

<span class="nc" id="L57">        sidebar.append(&quot;&lt;div class=\&quot;sidebar\&quot;&gt;&quot;);</span>

        // üìÑ Docs section
<span class="nc" id="L60">        sidebar.append(&quot;&lt;div class=\&quot;sidebar-section\&quot;&gt;&quot;);</span>
<span class="nc" id="L61">        sidebar.append(&quot;&lt;h3&gt;üìÑ Docs&lt;/h3&gt;&lt;ul&gt;&quot;);</span>
<span class="nc bnc" id="L62" title="All 2 branches missed.">        for (String name : filenames) {</span>
<span class="nc" id="L63">            sidebar.append(String.format(&quot;&lt;li&gt;&lt;a href=\&quot;/docs/view/%s\&quot;&gt;%s&lt;/a&gt;&lt;/li&gt;&quot;, name, name));</span>
<span class="nc" id="L64">        }</span>
<span class="nc" id="L65">        sidebar.append(&quot;&lt;/ul&gt;&lt;/div&gt;&quot;);</span>

        // üßÆ Recent requests section
<span class="nc" id="L68">        sidebar.append(&quot;&lt;div class=\&quot;sidebar-section recent-requests\&quot;&gt;&quot;);</span>
<span class="nc" id="L69">        sidebar.append(&quot;&lt;h3&gt;üßÆ Recent Requests&lt;/h3&gt;&quot;);</span>
<span class="nc" id="L70">        sidebar.append(buildRecentRequestTable());</span>
<span class="nc" id="L71">        sidebar.append(&quot;&lt;/div&gt;&quot;);</span>

        // ‚öôÔ∏è Prime request form section
<span class="nc" id="L74">        sidebar.append(&quot;&lt;div class=\&quot;sidebar-section request-form\&quot;&gt;&quot;);</span>
<span class="nc" id="L75">        sidebar.append(&quot;&lt;h3&gt;‚öôÔ∏è Run Prime Request&lt;/h3&gt;&quot;);</span>
<span class="nc" id="L76">        sidebar.append(buildRequestForm());</span>
<span class="nc" id="L77">        sidebar.append(&quot;&lt;/div&gt;&quot;);</span>

<span class="nc" id="L79">        sidebar.append(&quot;&lt;/div&gt;&quot;);</span>
<span class="nc" id="L80">        return sidebar.toString();</span>
    }

    public static String buildRequestForm() {
<span class="nc" id="L84">        return &quot;&quot;&quot;</span>
    &lt;form id=&quot;primeRequestForm&quot; onsubmit=&quot;submitPrimeRequest(event)&quot;&gt;
        &lt;label for=&quot;algorithm&quot;&gt;Algorithm:&lt;/label&gt;
        &lt;select id=&quot;algorithm&quot; name=&quot;algorithm&quot;&gt;
            &lt;option value=&quot;trial&quot;&gt;Trial&lt;/option&gt;
            &lt;option value=&quot;sieve&quot;&gt;Sieve&lt;/option&gt;
            &lt;option value=&quot;miller&quot;&gt;Miller&lt;/option&gt;
            &lt;option value=&quot;atkin&quot;&gt;Atkin&lt;/option&gt;
        &lt;/select&gt;

        &lt;label for=&quot;limit&quot;&gt;Limit:&lt;/label&gt;
        &lt;input type=&quot;number&quot; id=&quot;limit&quot; name=&quot;limit&quot; min=&quot;1&quot; required&gt;

        &lt;label for=&quot;threads&quot;&gt;Threads:&lt;/label&gt;
        &lt;input type=&quot;number&quot; id=&quot;threads&quot; name=&quot;threads&quot; min=&quot;1&quot; max=&quot;128&quot; required&gt;

        &lt;label for=&quot;useCache&quot;&gt;
            &lt;input type=&quot;checkbox&quot; id=&quot;useCache&quot; name=&quot;useCache&quot; checked&gt;
            Use Cache
        &lt;/label&gt;

        &lt;button type=&quot;submit&quot;&gt;Run&lt;/button&gt;
    &lt;/form&gt;
    &lt;div id=&quot;requestResult&quot; style=&quot;margin-top: 1rem; font-size: 0.9em;&quot;&gt;&lt;/div&gt;
    &quot;&quot;&quot;;
    }

    public static String buildIndexContent(List&lt;String&gt; filenames) {
<span class="nc" id="L112">        List&lt;String&gt; algorithmDocs = List.of(</span>
                &quot;Trial.md&quot;, &quot;Sieve.md&quot;, &quot;Atkin.md&quot;, &quot;Miller.md&quot;
        );

<span class="nc" id="L116">        List&lt;String&gt; infoDocs = List.of(</span>
                 &quot;Error-Handling.md&quot;, &quot;Testing.md&quot;, &quot;RestApis.md&quot;, &quot;Performance.md&quot;
        );

<span class="nc" id="L120">        StringBuilder content = new StringBuilder(&quot;&lt;h1&gt;üìö Documentation Index&lt;/h1&gt;&quot;);</span>

<span class="nc" id="L122">        content.append(&quot;&lt;h2&gt;&lt;a href=\&quot;/docs/view/Prime-Algorithms.md\&quot;&gt;üßÆ Algorithms&lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;&quot;);</span>
<span class="nc bnc" id="L123" title="All 2 branches missed.">        for (String name : filenames) {</span>
<span class="nc bnc" id="L124" title="All 2 branches missed.">            if (algorithmDocs.contains(name)) {</span>
<span class="nc" id="L125">                content.append(String.format(&quot;&lt;li&gt;&lt;a href=\&quot;/docs/view/%s\&quot;&gt;%s&lt;/a&gt;&lt;/li&gt;&quot;, name, name));</span>
            }
<span class="nc" id="L127">        }</span>
<span class="nc" id="L128">        content.append(&quot;&lt;/ul&gt;&quot;);</span>

<span class="nc" id="L130">        content.append(&quot;&lt;h2&gt;üìò Informational&lt;/h2&gt;&lt;ul&gt;&quot;);</span>
<span class="nc bnc" id="L131" title="All 2 branches missed.">        for (String name : filenames) {</span>
<span class="nc bnc" id="L132" title="All 2 branches missed.">            if (infoDocs.contains(name)) {</span>
<span class="nc" id="L133">                content.append(String.format(&quot;&lt;li&gt;&lt;a href=\&quot;/docs/view/%s\&quot;&gt;%s&lt;/a&gt;&lt;/li&gt;&quot;, name, name));</span>
            }
<span class="nc" id="L135">        }</span>
<span class="nc" id="L136">        content.append(&quot;&lt;/ul&gt;&quot;);</span>

<span class="nc" id="L138">        content.append(&quot;&lt;h2&gt;üì¶ Miscellaneous&lt;/h2&gt;&lt;ul&gt;&quot;);</span>
<span class="nc bnc" id="L139" title="All 2 branches missed.">        for (String name : filenames) {</span>
<span class="nc bnc" id="L140" title="All 4 branches missed.">            if (!algorithmDocs.contains(name) &amp;&amp; !infoDocs.contains(name)) {</span>
<span class="nc" id="L141">                content.append(String.format(&quot;&lt;li&gt;&lt;a href=\&quot;/docs/view/%s\&quot;&gt;%s&lt;/a&gt;&lt;/li&gt;&quot;, name, name));</span>
            }
<span class="nc" id="L143">        }</span>
<span class="nc" id="L144">        content.append(&quot;&lt;/ul&gt;&quot;);</span>

<span class="nc" id="L146">        return content.toString();</span>
    }

    public static String wrapHtml(String sidebar, String contentHtml, boolean includeBacklinks) {
<span class="nc bnc" id="L150" title="All 2 branches missed.">        String backlinks = includeBacklinks ? &quot;&quot;&quot;</span>
        &lt;div class=&quot;backlink&quot;&gt;
            &lt;p&gt;&lt;a href=&quot;/docs/view/Prime-Algorithms.md&quot;&gt;‚Üê Back to Prime Algorithms Overview&lt;/a&gt;&lt;/p&gt;
            &lt;p&gt;&lt;a href=&quot;/docs&quot;&gt;‚Üê Back to Documentation Index&lt;/a&gt;&lt;/p&gt;
        &lt;/div&gt;
<span class="nc" id="L155">    &quot;&quot;&quot; : &quot;&quot;;</span>

<span class="nc" id="L157">        return &quot;&quot;&quot;</span>
        &lt;html&gt;
        &lt;head&gt;
            &lt;title&gt;Documentation Viewer&lt;/title&gt;
            &quot;&quot;&quot;+styleBlock+&quot;&quot;&quot;
        &lt;/head&gt;
        &quot;&quot;&quot;+jsBlock+&quot;&quot;&quot;
        &lt;body&gt;
        &quot;&quot;&quot; + sidebar + &quot;&quot;&quot;
        &lt;div class=&quot;content&quot;&gt;
        &quot;&quot;&quot; + contentHtml + backlinks + &quot;&quot;&quot;
        &lt;/div&gt;
        &lt;/body&gt;
        &lt;/html&gt;
    &quot;&quot;&quot;;
    }

    public static boolean isValidMarkdownFile(String filename) {
<span class="nc bnc" id="L175" title="All 2 branches missed.">        return HtmlHelper.class.getClassLoader().getResource(&quot;docs/&quot; + filename) != null;</span>
    }

    public static String readMarkdown(String filename) throws IOException {
<span class="nc" id="L179">        try (var in = HtmlHelper.class.getClassLoader().getResourceAsStream(&quot;docs/&quot; + filename)) {</span>
<span class="nc bnc" id="L180" title="All 2 branches missed.">            if (in == null) throw new IOException(&quot;Markdown file not found: &quot; + filename);</span>
<span class="nc" id="L181">            return new String(in.readAllBytes(), java.nio.charset.StandardCharsets.UTF_8);</span>
        }
    }
    public static String convertMarkdownToHtml(String filename, String markdown) {
<span class="nc" id="L185">        String html = MarkdownConverter.toHtml(markdown);</span>
<span class="nc bnc" id="L186" title="All 2 branches missed.">        if (filename.equals(&quot;Prime-Algorithms.md&quot;)) {</span>
<span class="nc" id="L187">            html += buildAlgorithmTable();</span>
        }
<span class="nc" id="L189">        return html;</span>
    }


    public static String buildAlgorithmTable() {
<span class="nc" id="L194">        return &quot;&quot;&quot;</span>
        &lt;h2&gt;üìä Algorithm Comparison&lt;/h2&gt;
        &lt;table&gt;
          &lt;thead&gt;
            &lt;tr&gt;
              &lt;th&gt;Algorithm&lt;/th&gt;
              &lt;th&gt;Time Complexity&lt;/th&gt;
              &lt;th&gt;Use Case Notes&lt;/th&gt;
            &lt;/tr&gt;
          &lt;/thead&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td&gt;Trial Division&lt;/td&gt;
              &lt;td&gt;O(‚àön)&lt;/td&gt;
              &lt;td&gt;Simple, slow; good for small inputs or teaching&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;Sieve of Eratosthenes&lt;/td&gt;
              &lt;td&gt;O(n log log n)&lt;/td&gt;
              &lt;td&gt;Fast for generating all primes up to n&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;Miller-Rabin&lt;/td&gt;
              &lt;td&gt;O(k log¬≥ n)&lt;/td&gt;
              &lt;td&gt;Probabilistic; efficient for testing if one number is prime&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;Sieve of Atkin&lt;/td&gt;
              &lt;td&gt;O(n) (theoretical)&lt;/td&gt;
              &lt;td&gt;Complex; faster than Eratosthenes for large n&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
    &quot;&quot;&quot;;
    }

    public static String buildRecentRequestTable() {
<span class="nc" id="L231">        List&lt;PrimePayload&gt; recent = PrimeRequestLog.getRecent();</span>
<span class="nc bnc" id="L232" title="All 2 branches missed.">        if (recent.isEmpty()) return &quot;&lt;p&gt;No recent /api/primes requests logged.&lt;/p&gt;&quot;;</span>

<span class="nc" id="L234">        StringBuilder table = new StringBuilder(&quot;&quot;&quot;</span>
        &lt;h2&gt;üßÆ Recent Prime Requests&lt;/h2&gt;
        &lt;table&gt;
            &lt;thead&gt;
                &lt;tr&gt;
                    &lt;th&gt;Algorithm&lt;/th&gt;
                    &lt;th&gt;Limit&lt;/th&gt;
                    &lt;th&gt;Threads&lt;/th&gt;
                    &lt;th&gt;Total&lt;/th&gt;
                    &lt;th&gt;Duration (ms)&lt;/th&gt;
                &lt;/tr&gt;
            &lt;/thead&gt;
            &lt;tbody&gt;
    &quot;&quot;&quot;);

<span class="nc bnc" id="L249" title="All 2 branches missed.">        for (PrimePayload p : recent) {</span>
<span class="nc" id="L250">            table.append(String.format(&quot;&quot;&quot;</span>
        &lt;tr&gt;
            &lt;td&gt;%s&lt;/td&gt;
            &lt;td&gt;%d&lt;/td&gt;
            &lt;td&gt;%d&lt;/td&gt;
            &lt;td&gt;%d&lt;/td&gt;
            &lt;td&gt;%d&lt;/td&gt;
        &lt;/tr&gt;
<span class="nc" id="L258">        &quot;&quot;&quot;, p.getAlgorithm(), p.getLimit(), p.getThreads(), p.getTotal(), p.getDurationMs()));</span>
<span class="nc" id="L259">        }</span>

<span class="nc" id="L261">        table.append(&quot;&lt;/tbody&gt;&lt;/table&gt;&quot;);</span>
<span class="nc" id="L262">        return table.toString();</span>
    }



<span class="nc" id="L267">    private static String styleBlock = &quot;&quot;&quot;</span>
                &lt;style&gt;
                body {
                    margin: 0;
                    font-family: sans-serif;
                    display: flex;
                }
                .sidebar {
                    width: 220px;
                    max-width: 220px;
                    background-color: #f4f4f4;
                    padding: 1rem;
                    border-right: 1px solid #ddd;
                    overflow-x: hidden;
                }
                .sidebar h3 {
                    margin-top: 0;
                }
                .sidebar ul {
                    list-style: none;
                    padding-left: 0;
                }
                .sidebar li {
                    margin: 0.5rem 0;
                }
                .sidebar a {
                    color: #007acc;
                    text-decoration: none;
                }
                .sidebar a:hover {
                    text-decoration: underline;
                }
                .content {
                    flex: 1;
                    padding: 2rem;
                    max-width: 800px;
                }
                h1, h2, h3 {
                    color: #333;
                }
                a {
                    color: #007acc;
                    text-decoration: none;
                }
                a:hover {
                    text-decoration: underline;
                }
                .backlink {
                    margin-top: 3rem;
                    font-size: 0.9rem;
                }
                .recent-requests {
                            margin-top: 2rem;
                            font-size: 0.85em;
                        }
                
                        .recent-requests table {
                                        width: 100%;
                                        table-layout: fixed;
                                        word-wrap: break-word;
                                        font-size: 0.8em;
                                    }
                
                        .recent-requests th,
                                     .recent-requests td {
                                         padding: 4px;
                                         text-align: left;
                                         overflow: hidden;
                                         text-overflow: ellipsis;
                                         white-space: nowrap;
                                     }
                
                        .recent-requests tr:hover {
                            background-color: #f5f5f5;
                        }
                        .request-form {
                                    margin-top: 2rem;
                                    font-size: 0.85em;
                                }
                
                                .request-form label {
                                    display: block;
                                    margin-top: 0.5rem;
                                }
                
                                .request-form input,
                                .request-form select {
                                    width: 100%;
                                    padding: 4px;
                                    margin-top: 0.2rem;
                                    box-sizing: border-box;
                                }
                
                                .request-form button {
                                    margin-top: 0.8rem;
                                    padding: 6px 12px;
                                    background-color: #007acc;
                                    color: white;
                                    border: none;
                                    cursor: pointer;
                                }
                
                                .request-form button:hover {
                                    background-color: #005fa3;
                                }
            &lt;/style&gt;
&quot;&quot;&quot;;

<span class="nc" id="L375">    private static String jsBlock = &quot;&quot;&quot;</span>
            &lt;script&gt;
            function submitPrimeRequest(event) {
                event.preventDefault();
            
                const algo = document.getElementById(&quot;algorithm&quot;).value;
                const limit = parseInt(document.getElementById(&quot;limit&quot;).value, 10);
                const threads = parseInt(document.getElementById(&quot;threads&quot;).value, 10);
                const useCache = document.getElementById(&quot;useCache&quot;).checked;
            
                if (isNaN(limit) || limit &lt; 1) {
                    alert(&quot;Limit must be a positive integer.&quot;);
                    return;
                }
            
                if (isNaN(threads) || threads &lt; 1 || threads &gt; 128) {
                    alert(&quot;Threads must be between 1 and 128.&quot;);
                    return;
                }
            
                const url = `/api/primes?algorithm=${algo}&amp;limit=${limit}&amp;threads=${threads}&amp;useCache=${useCache}`;
                fetch(url)
                    .then(res =&gt; res.json())
                    .then(data =&gt; {
                        const resultDiv = document.getElementById(&quot;requestResult&quot;);
                        resultDiv.innerHTML = `&lt;strong&gt;Result:&lt;/strong&gt; ${data.total} primes in ${data.durationMs}ms`;
                    })
                    .catch(err =&gt; {
                        document.getElementById(&quot;requestResult&quot;).innerHTML = `&lt;span style=&quot;color:red;&quot;&gt;Error: ${err}&lt;/span&gt;`;
                    });
            }
            &lt;/script&gt;
            &quot;&quot;&quot;;


}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>